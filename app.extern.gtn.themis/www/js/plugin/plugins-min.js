var plugins={config:null,pluginNames:[],constructor:function(){if(!plugins.loadPluginConfig()){alert("Fatal error: plugins.loadPluginConfig()")}else{if(!plugins.verifyPluginNames()){alert("Fatal error: plugins.verifyPluginNames()")}else{if(!plugins.loadPlugins()){alert("Fatal error: plugins.loadPlugins()")}}}plugins.callPluginsLoadedEvent();plugins.callPluginEvents()},loadPluginConfig:function(){var b=null;var a="../js/plugin/plugins.json";$.ajax({url:a,async:false,dataType:"json",success:function(c){plugins.config=c;b=true},error:function(c,e,d){alert("Fatal error in javascriptLoader.js: Can't load the plugin config. Url: "+a+" Error: "+e);b=false}});return b},verifyPluginNames:function(){return true},onPluginLoaded:function(a){var c=true;if(window["plugin_"+a]==undefined){alert("Fatal error: Plugin class is not defined: plugin_"+a);c=false;return}try{window["plugin_"+a].config=JsonLoader("../js/plugin/plugin."+a+".json");if(window["plugin_"+a].config.name==undefined){alert("Fatal error: The property 'name' is not defined in JSON file: ../js/plugin."+a+".json");return false}if(window["plugin_"+a].config.shortname==undefined){alert("Fatal error: The property 'shortname' is not defined in JSON file: ../js/plugin."+a+".json");return false}}catch(b){alert("Fatal error: The plugin has no 'config' property: "+a);c=false;return}try{window["plugin_"+a].constructor()}catch(b){alert("Fatal error: The plugin has no constructor(): "+a);c=false;return}try{app.addObject(window["plugin_"+a].config.name,window["plugin_"+a].functions);app.addObject(window["plugin_"+a].config.shortname,window["plugin_"+a].functions)}catch(b){alert("Fatal error: The plugin has no functions{}: "+a);c=false;return}plugins.pluginNames.push(a);return c},loadPlugins:function(){var b=true;var a="";if(app.config.min){a="-min"}$.each(plugins.config,function(d,e){if(e==true){if(app.config.onefile){b=plugins.onPluginLoaded(d)}else{var c="../js/plugin/plugin."+d+a+".js";$.ajax({url:c,async:false,dataType:"script",success:function(f){b=plugins.onPluginLoaded(d)},error:function(f,h,g){alert("Fatal Error: Can't load plugin: "+c);b=false;return}})}}if(!b){return false}});return b},callPluginsLoadedEvent:function(){$.each(plugins.pluginNames,function(a,c){try{window["plugin_"+c].pluginsLoaded()}catch(b){alert("Notify: The plugin has no pluginsLoaded() event handler: plugin_"+c)}})},callPluginEvents:function(){$.each(plugins.pluginNames,function(a,c){try{window["plugin_"+c].definePluginEvents()}catch(b){app.debug.alert("Notify: The plugin has no definePluginEvents() method: plugin_"+c,10)}})}};plugins.constructor();
